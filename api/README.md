# PHP API для Open CRM

Небольшой REST-бэкенд без зависимостей, который можно развернуть на любом PHP-хостинге рядом со статичными страницами из каталога `dist`.

## Основные возможности
- Маршрутизация через `api/index.php` и `.htaccess` без внешних библиотек.
- CORS-заголовки для работы с фронтендом из каталога `dist` или из других доменов.
- Файловое хранилище `data/data.json` с тестовыми данными и автоматическим созданием при первом запуске.
- CRUD для основных сущностей CRM (пользователи, группы компаний, контрагенты, контракты, сделки, статусы сделок).
- Простая авторизация: `POST /api/auth/login` с email из списка пользователей и паролем `password` возвращает условный токен.

## Запуск
1. Скопируйте каталог `api` и файл `data/data.json` на PHP-хостинг рядом с каталогом `dist`.
2. Убедитесь, что PHP имеет права на запись в `data/data.json` (для записи новых элементов и удаления существующих).
3. При использовании Apache оставьте `.htaccess` для маршрутизации всех запросов в `api/index.php`. Для других серверов настройте аналогичный rewrite.

## Примеры запросов
- **Проверка здоровья:** `GET /api/health`
- **Аутентификация:** `POST /api/auth/login` с телом `{ "email": "ivan@example.com", "password": "password" }`
- **Получение списка:** `GET /api/users`
- **Добавление элемента:** `POST /api/deals` с JSON телом `{ "title": "Новая сделка", "status_id": 1, "value": 100000 }`
- **Обновление:** `PATCH /api/users/1` с телом `{ "phone": "+7 900 000-00-03" }`
- **Удаление:** `DELETE /api/contracts/1`

Все ответы возвращаются в JSON с кодировкой UTF-8 и подробными сообщениями об ошибках.
